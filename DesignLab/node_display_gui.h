//! @file node_display_gui.h
//! @brief ノードの情報を表示するGUI

#ifndef DESIGNLAB_NODE_DISPLAY_GUI_H_
#define DESIGNLAB_NODE_DISPLAY_GUI_H_

#include <memory>
#include <map>

#include "node.h"
#include "button_controller.h"
#include "abstract_hexapod_state_calculator.h"


//! @class NodeDisplayGui
//! @date 2023/08/23
//! @author 長谷川
//! @brief ノードの情報を表示するGUI
class NodeDisplayGui final
{
public:

	//! @param [in] x_pos GUIの左上のx座標
	//! @param [in] y_pos GUIの左上のy座標
	//! @param [in] calc 六脚歩行ロボットの状態を計算するクラス
	NodeDisplayGui(const int x_pos, const int y_pos, std::shared_ptr<AbstractHexapodStateCalculator> calc);


	//! @brief 表示するノードを設定する，その後関節の角度を計算する
	//! @param [in] node 表示するノード
	void SetDisplayNode(const SNode& node);


	//! @brief GUIのボタンの更新を行う
	void Update();

	//! @brief GUIの表示を行う
	void Draw() const;


	const static int kWidth;			//!< GUIの幅
	const static int kHeight;			//!< GUIの高さ
	const static int kClosedHeight;		//!< GUIが閉じているときの高さ

private:

	enum class ButtonType
	{
		kOpenClose,
		kModeSwitching
	};

	enum class DisplayMode
	{
		kDefualt,		//デフォルト
		kJointState		//角度
	};


	void drawBackground() const;

	void drawNodeInfo() const;

	void drawJointInfo() const;


	const int kGUILeftPosX;

	const int kGUITopPosY;


	std::map<ButtonType, std::unique_ptr<ButtomController>> buttons_;	//!< ボタン

	std::shared_ptr<AbstractHexapodStateCalculator> calculator_ptr_;		//!< 六脚歩行ロボットの状態を計算するクラス


	SNode display_node_;										//!< 表示するノード

	SHexapodJointState joint_state_[HexapodConst::LEG_NUM];	//!< 関節の角度

	bool is_closed_;											//!< GUIが閉じているか(最小化しているか)どうか

	DisplayMode display_type_;									//!< 表示する情報の種類
};


#endif // !DESIGNLAB_NODE_DISPLAY_GUI_H_